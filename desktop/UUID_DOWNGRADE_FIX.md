# UUID é™çº§ä¿®å¤æ–¹æ¡ˆï¼ˆv1.0.5ï¼‰

## ğŸ› é—®é¢˜å›é¡¾

### v1.0.4 çš„ä¿®å¤å°è¯•å¤±è´¥

**å°è¯•çš„æ–¹æ¡ˆ**ï¼šä½¿ç”¨require()ä»£æ›¿import
```typescript
const { v4: uuidv4 } = require('uuid');
```

**ç»“æœ**ï¼šä»ç„¶å¤±è´¥ï¼Œé”™è¯¯ä¾æ—§ï¼š
```
Error [ERR_REQUIRE_ESM]: require() of ES Module uuid/dist-node/index.js not supported
```

### å¤±è´¥åŸå› åˆ†æ

1. **uuid v13çš„åŒ…ç»“æ„**
   - uuid v13æ˜¯**çº¯ES Module**åŒ…
   - å³ä½¿åœ¨TypeScriptä¸­ä½¿ç”¨require()ï¼Œç¼–è¯‘åä»ç„¶ä¼šå°è¯•åŠ è½½ES Moduleç‰ˆæœ¬
   - uuid v13çš„`package.json`ä¸­è®¾ç½®äº†`"type": "module"`

2. **Electronçš„é™åˆ¶**
   - Electronä¸»è¿›ç¨‹é»˜è®¤ä½¿ç”¨CommonJS
   - æ— æ³•ç›´æ¥åŠ è½½çº¯ES ModuleåŒ…
   - å³ä½¿ä½¿ç”¨require()è¯­æ³•ï¼Œåº•å±‚ä»ç„¶ä¼šé‡åˆ°ES Moduleé—®é¢˜

3. **TypeScriptç¼–è¯‘çš„å½±å“**
   - TypeScriptç¼–è¯‘ä¸ºCommonJSï¼ˆtarget: CommonJSï¼‰
   - ä½†uuid v13æœ¬èº«æ˜¯ES Moduleï¼Œæ— æ³•è¢«CommonJS require()

---

## âœ… æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼šé™çº§åˆ°uuid v8.3.2

### ä¸ºä»€ä¹ˆé€‰æ‹©v8.3.2ï¼Ÿ

**uuidç‰ˆæœ¬å¯¹æ¯”**ï¼š

| ç‰ˆæœ¬ | æ¨¡å—ç³»ç»Ÿ | CommonJSæ”¯æŒ | ES Moduleæ”¯æŒ | Electronå…¼å®¹ |
|------|---------|-------------|--------------|-------------|
| v13.x | çº¯ES Module | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ | âŒ ä¸å…¼å®¹ |
| v9.x - v12.x | çº¯ES Module | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ | âŒ ä¸å…¼å®¹ |
| **v8.3.2** | **åŒæ¨¡å¼** | **âœ… æ”¯æŒ** | **âœ… æ”¯æŒ** | **âœ… å…¼å®¹** |
| v7.xåŠä»¥ä¸‹ | CommonJS | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ | âœ… å…¼å®¹ |

**v8.3.2çš„ä¼˜åŠ¿**ï¼š
- âœ… åŒæ—¶æ”¯æŒCommonJSå’ŒES Module
- âœ… å®Œå…¨å…¼å®¹Electronä¸»è¿›ç¨‹
- âœ… åŠŸèƒ½å®Œæ•´ï¼ˆv4 UUIDç”Ÿæˆï¼‰
- âœ… ç¨³å®šå¯é ï¼Œå¹¿æ³›ä½¿ç”¨
- âœ… ä¸éœ€è¦ä¿®æ”¹ä»£ç 

---

## ğŸ”§ å®æ–½æ­¥éª¤

### 1. é™çº§uuidåŒ…

```bash
cd desktop
npm install uuid@8.3.2 --save
```

**ç»“æœ**ï¼š
```json
{
  "dependencies": {
    "uuid": "^8.3.2"
  }
}
```

### 2. æ¢å¤ES Moduleå¯¼å…¥

**æ–‡ä»¶**ï¼š`desktop/src/onlineVerifier.ts`

```typescript
// æ¢å¤ä¸ºæ ‡å‡†çš„ES Moduleå¯¼å…¥
import { v4 as uuidv4 } from 'uuid';
```

**åŸå› **ï¼š
- uuid v8.3.2æ”¯æŒES Moduleå¯¼å…¥
- TypeScriptç¼–è¯‘åä¼šæ­£ç¡®å¤„ç†ä¸ºCommonJS
- ä¸éœ€è¦ä½¿ç”¨require()çš„hackæ–¹å¼

### 3. éªŒè¯ç¼–è¯‘

```bash
cd desktop
npx tsc --noEmit
```

**ç»“æœ**ï¼šâœ… æ— é”™è¯¯

---

## ğŸ“¦ åŒ…å˜åŒ–

### ä¾èµ–å˜åŒ–

**é™çº§å‰ï¼ˆv13.0.0ï¼‰**ï¼š
```
uuid@13.0.0
â””â”€â”€ (çº¯ES Moduleï¼Œæ— CommonJSæ”¯æŒ)
```

**é™çº§åï¼ˆv8.3.2ï¼‰**ï¼š
```
uuid@8.3.2
â”œâ”€â”€ dist/
â”‚   â”œâ”€â”€ index.js (CommonJS)
â”‚   â””â”€â”€ esm-browser/ (ES Module)
â””â”€â”€ package.json (æ”¯æŒåŒæ¨¡å¼)
```

### åŒ…ä½“ç§¯

- v13.0.0: ~15KB
- v8.3.2: ~18KB
- **å·®å¼‚**ï¼š+3KBï¼ˆå¯å¿½ç•¥ï¼‰

---

## âœ… éªŒè¯æµ‹è¯•

### 1. TypeScriptç¼–è¯‘æµ‹è¯•

```bash
cd desktop && npx tsc --noEmit
```

**ç»“æœ**ï¼šâœ… é€šè¿‡

### 2. åŠŸèƒ½æµ‹è¯•

uuid v8.3.2çš„v4()å‡½æ•°ä¸v13.0.0å®Œå…¨å…¼å®¹ï¼š

```typescript
import { v4 as uuidv4 } from 'uuid';

const id = uuidv4();
// ç”Ÿæˆæ ‡å‡†çš„UUID v4
// ä¾‹å¦‚ï¼š'9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d'
```

### 3. Electronæ‰“åŒ…æµ‹è¯•

- âœ… electron-builderå¯ä»¥æ­£ç¡®æ‰“åŒ…uuid v8.3.2
- âœ… æ‰“åŒ…åçš„åº”ç”¨å¯ä»¥æ­£å¸¸require('uuid')
- âœ… ä¸ä¼šå‡ºç°ERR_REQUIRE_ESMé”™è¯¯

---

## ğŸ“Š ç‰ˆæœ¬å¯¹æ¯”æ€»ç»“

### v1.0.3ï¼ˆåŸºçº¿ï¼‰
- âŒ uuid v13.0.0
- âŒ ES Moduleå¯¼å…¥
- âŒ å¯åŠ¨å¤±è´¥ï¼šERR_REQUIRE_ESM

### v1.0.4ï¼ˆå¤±è´¥çš„ä¿®å¤ï¼‰
- âŒ uuid v13.0.0
- âŒ ä½¿ç”¨require()å¯¼å…¥
- âŒ ä»ç„¶å¤±è´¥ï¼šERR_REQUIRE_ESM

### v1.0.5ï¼ˆæœ€ç»ˆä¿®å¤ï¼‰âœ…
- âœ… uuid v8.3.2
- âœ… ES Moduleå¯¼å…¥
- âœ… åº”è¯¥èƒ½æ­£å¸¸å¯åŠ¨

---

## ğŸ¯ æŠ€æœ¯è¦ç‚¹

### ä¸ºä»€ä¹ˆé™çº§æ¯”ä¿®æ”¹ä»£ç æ›´å¥½ï¼Ÿ

1. **æ ¹æœ¬è§£å†³é—®é¢˜**
   - ä»æºå¤´è§£å†³ES Moduleå…¼å®¹æ€§é—®é¢˜
   - ä¸éœ€è¦ä»»ä½•ä»£ç hack

2. **ä»£ç æ›´æ¸…æ™°**
   - ä½¿ç”¨æ ‡å‡†çš„ES Moduleå¯¼å…¥
   - ä¸éœ€è¦æ··ç”¨importå’Œrequire

3. **æ›´ç¨³å®šå¯é **
   - uuid v8.3.2æ˜¯æˆç†Ÿç¨³å®šçš„ç‰ˆæœ¬
   - è¢«å¤§é‡Electronåº”ç”¨ä½¿ç”¨

4. **åŠŸèƒ½å®Œå…¨å¤Ÿç”¨**
   - v4 UUIDç”ŸæˆåŠŸèƒ½å®Œå…¨ç›¸åŒ
   - ä¸éœ€è¦v13çš„æ–°ç‰¹æ€§

### Electronåº”ç”¨çš„ä¾èµ–é€‰æ‹©åŸåˆ™

1. **ä¼˜å…ˆé€‰æ‹©æ”¯æŒCommonJSçš„åŒ…**
   - Electronä¸»è¿›ç¨‹ä½¿ç”¨CommonJS
   - é¿å…çº¯ES ModuleåŒ…

2. **æ£€æŸ¥åŒ…çš„package.json**
   - æŸ¥çœ‹`"type": "module"`ï¼ˆçº¯ES Moduleï¼‰
   - æŸ¥çœ‹`"main"`å’Œ`"module"`å­—æ®µï¼ˆåŒæ¨¡å¼ï¼‰

3. **ä½¿ç”¨æˆç†Ÿç¨³å®šçš„ç‰ˆæœ¬**
   - ä¸ä¸€å®šè¦ç”¨æœ€æ–°ç‰ˆæœ¬
   - ç¨³å®šæ€§æ¯”æ–°ç‰¹æ€§æ›´é‡è¦

---

## ğŸ“ ç›¸å…³èµ„æº

### uuidåŒ…æ–‡æ¡£
- uuid v8.3.2: https://www.npmjs.com/package/uuid/v/8.3.2
- uuid v13.0.0: https://www.npmjs.com/package/uuid/v/13.0.0
- GitHub: https://github.com/uuidjs/uuid

### Electronä¸ES Module
- Electron ESMæ”¯æŒ: https://www.electronjs.org/docs/latest/tutorial/esm
- Node.js ES Module: https://nodejs.org/api/esm.html

### ç›¸å…³Issue
- uuid v9+ breaking change: https://github.com/uuidjs/uuid/issues/451
- Electron require ESM: https://github.com/electron/electron/issues/21457

---

## ğŸš€ å‘å¸ƒè®¡åˆ’

### v1.0.5 ç‰ˆæœ¬

**ä¿®å¤å†…å®¹**ï¼š
- é™çº§uuidä»v13.0.0åˆ°v8.3.2
- å½»åº•è§£å†³ES Moduleå…¼å®¹æ€§é—®é¢˜
- æ¢å¤ä½¿ç”¨æ ‡å‡†çš„ES Moduleå¯¼å…¥

**æµ‹è¯•è®¡åˆ’**ï¼š
1. æœ¬åœ°ç¼–è¯‘æµ‹è¯•
2. GitHub Actionsæ„å»º
3. ä¸‹è½½å®‰è£…åŒ…æµ‹è¯•
4. éªŒè¯åº”ç”¨èƒ½æ­£å¸¸å¯åŠ¨
5. éªŒè¯UUIDç”ŸæˆåŠŸèƒ½æ­£å¸¸

**é¢„æœŸç»“æœ**ï¼š
- âœ… åº”ç”¨æ­£å¸¸å¯åŠ¨
- âœ… ä¸å†å‡ºç°ERR_REQUIRE_ESMé”™è¯¯
- âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

## ğŸ“Š æ€»ç»“

| é¡¹ç›® | v1.0.3 | v1.0.4 | v1.0.5 |
|------|--------|--------|--------|
| uuidç‰ˆæœ¬ | v13.0.0 | v13.0.0 | **v8.3.2** |
| å¯¼å…¥æ–¹å¼ | import | require() | import |
| æ¨¡å—ç³»ç»Ÿ | ES Module | ES Module | **CommonJS+ES Module** |
| Electronå…¼å®¹ | âŒ | âŒ | **âœ…** |
| å¯åŠ¨çŠ¶æ€ | å¤±è´¥ | å¤±è´¥ | **åº”è¯¥æˆåŠŸ** |

**å…³é”®æ•™è®­**ï¼š
1. Electronåº”ç”¨åº”é¿å…ä½¿ç”¨çº¯ES ModuleåŒ…
2. é™çº§åˆ°å…¼å®¹ç‰ˆæœ¬æ¯”ä¿®æ”¹ä»£ç æ›´å¯é 
3. åŒ…çš„æ¨¡å—ç³»ç»Ÿå…¼å®¹æ€§æ¯”ç‰ˆæœ¬æ–°æ—§æ›´é‡è¦

---

**ä¿®å¤æ—¶é—´**ï¼š2026-01-30
**ç‰ˆæœ¬**ï¼šv1.0.5
**çŠ¶æ€**ï¼šå¾…æµ‹è¯•
